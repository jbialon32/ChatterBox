This is nearly all of the server side stuff!
